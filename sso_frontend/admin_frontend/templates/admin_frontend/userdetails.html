{% extends "admin_frontend/base.html" %}

{% block admin_content %}

<h2>Details for {{ duser.first_name }} {{ duser.last_name }} ({{ auser.username }})</h2>

<p>

<form class="inline-block" role="form" method="post" action="?">{% csrf_token %}
<button name="refresh" value="yes" type="submit" class="btn btn-primary">Refresh from FUM/LDAP</button>
</form> 

<form role="form" class="inline-block" method="post" action="?">{% csrf_token %}
<span class="tooltip-link" title="This will revoke Authenticator configuration and terminate all sessions for this user."><button name="revoke" value="yes" type="submit" class="btn btn-danger">Revoke Authenticator and sign out</button></span>
</form>

<form role="form" class="inline-block" method="post" action="?">{% csrf_token %}
<span class="tooltip-link" title="This will terminate all sessions for this user"><button name="signout" value="yes" type="submit" class="btn btn-danger">Terminate all sessions</button></span>
</form>

</p>

<table class="table table-striped table-responsive">
<tbody>
<tr>
<th>Username</th>
<td>{{ auser.username }}</td>
</tr>

<tr>
<th>First name</th>
<td>{{ duser.first_name }}</td>
</tr>

<tr>
<th>Last name</th>
<td>{{ duser.last_name }}</td>
</tr>

<tr>
<th>email</th>
<td>{{ auser.email }}</td>
</tr>

<tr>
<th>Primary phone number</th>
<td>{{ auser.primary_phone }} {% if auser.primary_phone %} - last changed <span class="tooltip-link" title="{{ auser.primary_phone_refresh|timesince }} ago">{{ auser.primary_phone_refresh }}</span>{% endif %}</td>
</tr>

<tr>
<th>Secondary phone number</th>
<td>{{ auser.secondary_phone }} {% if auser.secondary_phone %} - last changed <span class="tooltip-link" title="{{ auser.secondary_phone_refresh|timesince }} ago">{{ auser.secondary_phone_refresh }}</span>{% endif %}</td>
</tr>

<tr>
<th>Strong authentication configured</th>
<td>{{ auser.strong_configured }}</td>
</tr>

<tr>
<th>Strong authentication skips available</th>
<td>{{ auser.strong_skips_available }}</td>
</tr>

<tr>
<th>Legacy mode</th>
<td>{{ auser.emulate_legacy }}</td>
</tr>

<tr>
<th>Authenticator configured</th>
<td>{% if auser.strong_authenticator_generated_at %}<span class="tooltip-link" title="{{ auser.strong_authenticator_generated_at|timesince }} ago">At {{ auser.strong_authenticator_generated_at }}</span>{% else %}No{% endif %}</td>
</tr>

<tr>
<th><span class="tooltip-link" title="True, if Authenticator have been used successfully after previous reconfiguration">Authenticator used</span></th>
<td>{{ auser.strong_authenticator_used }}</td>
</tr>

<tr>
<th><span class="tooltip-link" title="True, if user has requested SMS authentication by default.">Always use SMS</span></th>
<td>{{ auser.strong_sms_always }}</td>
</tr>

<tr>
<th><span class="tooltip-link" title="True if user's strong authentication configuration was automatically revoked after primary phone was changed">Primary phone changed</span></th>
<td>{{ auser.primary_phone_changed }}</td>
</tr>

<tr>
<th><span class="tooltip-link" title="Only available after using pubtkt">pubtkt tokens</span></th>
<td>{{ auser.user_tokens }}</td>
</tr>
</tbody>
</table>


<h2>Browsers</h2>

{% include "admin_frontend/snippets/list_browsers.html" %}

<h2>Logins</h2>

{% include "admin_frontend/snippets/list_logins.html" %}

<h2>Log entries</h2>

<p><a class="btn btn-info" href="{% url 'user_logs' auser.username %}">View all</a></p>

{% include "admin_frontend/snippets/list_logs.html" %}

{% endblock %}
